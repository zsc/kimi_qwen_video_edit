<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Qwen Video Edit - TTLG å®éªŒæŠ¥å‘Š</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "PingFang SC", "Microsoft YaHei", sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }
        
        .header .subtitle {
            font-size: 1.2em;
            opacity: 0.9;
        }
        
        .content {
            padding: 40px;
        }
        
        .section {
            margin-bottom: 40px;
        }
        
        .section h2 {
            color: #667eea;
            font-size: 1.8em;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 3px solid #667eea;
            display: inline-block;
        }
        
        .section h3 {
            color: #764ba2;
            font-size: 1.3em;
            margin: 20px 0 15px 0;
        }
        
        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .info-card {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            padding: 20px;
            border-radius: 15px;
            border-left: 5px solid #667eea;
        }
        
        .info-card h4 {
            color: #667eea;
            margin-bottom: 10px;
        }
        
        .comparison {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            margin: 30px 0;
        }
        
        .frame-group {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        
        .frame-group h4 {
            text-align: center;
            color: #667eea;
            margin-bottom: 15px;
            font-size: 1.2em;
        }
        
        .frame {
            margin: 15px 0;
            text-align: center;
        }
        
        .frame img {
            max-width: 100%;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            transition: transform 0.3s;
        }
        
        .frame img:hover {
            transform: scale(1.02);
        }
        
        .frame-label {
            margin-top: 10px;
            font-weight: bold;
            color: #555;
        }
        
        .analysis-box {
            background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
        }
        
        .analysis-box h4 {
            color: #e74c3c;
            margin-bottom: 15px;
        }
        
        .observation-list {
            list-style: none;
            padding: 0;
        }
        
        .observation-list li {
            padding: 10px 0;
            padding-left: 30px;
            position: relative;
            border-bottom: 1px dashed #ddd;
        }
        
        .observation-list li:last-child {
            border-bottom: none;
        }
        
        .observation-list li::before {
            content: "âœ“";
            position: absolute;
            left: 0;
            color: #27ae60;
            font-weight: bold;
            font-size: 1.2em;
        }
        
        .observation-list li.warning::before {
            content: "âš ";
            color: #f39c12;
        }
        
        .observation-list li.info::before {
            content: "â„¹";
            color: #3498db;
        }
        
        .code-block {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 20px;
            border-radius: 10px;
            overflow-x: auto;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            margin: 15px 0;
        }
        
        .highlight {
            background: linear-gradient(120deg, #a8edea 0%, #fed6e3 100%);
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }
        
        .two-col {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        
        @media (max-width: 768px) {
            .two-col {
                grid-template-columns: 1fr;
            }
            .comparison {
                grid-template-columns: 1fr;
            }
        }
        
        .footer {
            background: #2c3e50;
            color: white;
            text-align: center;
            padding: 20px;
            font-size: 0.9em;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        
        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        
        th {
            background: #667eea;
            color: white;
        }
        
        tr:hover {
            background: #f5f5f5;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ¬ Qwen Video Edit</h1>
            <p class="subtitle">Test-Time Loss Guidance (TTLG) å®éªŒæŠ¥å‘Š</p>
        </div>
        
        <div class="content">
            <!-- å®éªŒæ¦‚è¿° -->
            <div class="section">
                <h2>ğŸ“‹ å®éªŒæ¦‚è¿°</h2>
                <p>æœ¬å®éªŒéªŒè¯äº†åŸºäº Qwen-Image-Edit-2509 çš„è§†é¢‘ç¼–è¾‘å·¥å…·ï¼Œé€šè¿‡ Test-Time Loss Guidance (TTLG) æŠ€æœ¯åœ¨æ¨ç†é˜¶æ®µå¼•å…¥æ¢¯åº¦å¼•å¯¼ï¼Œå®ç°æ— éœ€è®­ç»ƒçš„æ—¶åºä¸€è‡´è§†é¢‘ç”Ÿæˆã€‚</p>
                
                <div class="info-grid">
                    <div class="info-card">
                        <h4>ğŸ¯ å®éªŒç›®æ ‡</h4>
                        <p>éªŒè¯ TTLG è¾¹ç¼˜å¼•å¯¼å’Œé£æ ¼å¼•å¯¼åœ¨è§†é¢‘å¸§ç”Ÿæˆä¸­çš„æœ‰æ•ˆæ€§</p>
                    </div>
                    <div class="info-card">
                        <h4>ğŸ“Š æµ‹è¯•è§„æ¨¡</h4>
                        <p>3 å¸§åºåˆ—ï¼ˆ1 å¼ åˆå§‹åŒ–å¸§ + 2 å¼ è¾¹ç¼˜æ§åˆ¶å¸§ï¼‰</p>
                    </div>
                    <div class="info-card">
                        <h4>âš™ï¸ æ¨ç†æ­¥æ•°</h4>
                        <p>4 æ­¥å»å™ªï¼ŒTTLG åœ¨æœ€å 2 æ­¥å¯ç”¨</p>
                    </div>
                    <div class="info-card">
                        <h4>ğŸ”§ åˆ†è¾¨ç‡</h4>
                        <p>è¾“å…¥ 512Ã—512ï¼Œè¾“å‡º 1024Ã—1024ï¼ˆVAE ä¸Šé‡‡æ ·ï¼‰</p>
                    </div>
                </div>
            </div>
            
            <!-- æ–¹æ³•è¯´æ˜ -->
            <div class="section">
                <h2>ğŸ”¬ æŠ€æœ¯æ–¹æ³•</h2>
                
                <h3>TTLG (Test-Time Loss Guidance)</h3>
                <p>åœ¨æ‰©æ•£æ¨¡å‹çš„å»å™ªè¿‡ç¨‹ä¸­ï¼Œé€šè¿‡å›è°ƒå‡½æ•°åœ¨æ¯ä¸ªæ—¶é—´æ­¥ç»“æŸæ—¶è®¡ç®—æŸå¤±æ¢¯åº¦ï¼Œå¹¶æ›´æ–°æ½œå˜é‡ï¼Œå¼•å¯¼ç”Ÿæˆç»“æœæœå‘ç›®æ ‡ç‰¹æ€§ï¼š</p>
                
                <div class="highlight">
                    <strong>æ ¸å¿ƒå…¬å¼ï¼š</strong><br>
                    <code>latents = latents - lr * âˆ‡<sub>latents</sub>(L<sub>edge</sub> + L<sub>gram</sub>)</code>
                </div>
                
                <table>
                    <tr>
                        <th>æŸå¤±ç±»å‹</th>
                        <th>ä½œç”¨</th>
                        <th>æƒé‡</th>
                    </tr>
                    <tr>
                        <td>Edge Loss (è¾¹ç¼˜æŸå¤±)</td>
                        <td>ä½¿ç”Ÿæˆå›¾åƒçš„è¾¹ç¼˜ä¸ç›®æ ‡è¾¹ç¼˜å¯¹é½</td>
                        <td>1.0</td>
                    </tr>
                    <tr>
                        <td>Gram Loss (é£æ ¼æŸå¤±)</td>
                        <td>ä¿æŒä¸åˆå§‹åŒ–å¸§çš„é£æ ¼ä¸€è‡´æ€§</td>
                        <td>0.2</td>
                    </tr>
                    <tr>
                        <td>Temporal Loss (æ—¶åºæŸå¤±)</td>
                        <td>ä¿æŒå¸§é—´æ—¶åºè¿ç»­æ€§</td>
                        <td>0.0ï¼ˆæœªå¯ç”¨ï¼‰</td>
                    </tr>
                </table>
                
                <h3>å…³é”®ä¿®å¤</h3>
                <ul class="observation-list">
                    <li>å®ç°æ½œå˜é‡è§£åŒ…ï¼šQwen ä½¿ç”¨æ‰“åŒ…æ ¼å¼ (B, 4096, 64) â†’ VAE æ ¼å¼ (B, 16, 1, 128, 128)</li>
                    <li>åº”ç”¨ VAE å½’ä¸€åŒ–ï¼šlatents_mean å’Œ latents_std æ ¡æ­£</li>
                    <li>ä¿æŒåŸå§‹æ•°æ®ç±»å‹ (bfloat16) ç¡®ä¿æ•°å€¼ç¨³å®šæ€§</li>
                    <li>ä¿®å¤æ¢¯åº¦å½’ä¸€åŒ–ä»¥æ”¯æŒ 3D æ‰“åŒ…æ½œå˜é‡</li>
                </ul>
            </div>
            
            <!-- å®éªŒç»“æœ -->
            <div class="section">
                <h2>ğŸ–¼ï¸ å®éªŒç»“æœ</h2>
                
                <h3>è¾“å…¥æ•°æ®</h3>
                <div class="comparison">
                    <div class="frame-group">
                        <h4>åˆå§‹åŒ–å¸§ (frame_0000)</h4>
                        <div class="frame">
                            <img src="data/init.png" alt="åˆå§‹åŒ–å¸§">
                            <div class="frame-label">512Ã—512 å½©è‰²æ¸å˜ + åœ†å½¢ + æ–¹å½¢</div>
                        </div>
                    </div>
                    <div class="frame-group">
                        <h4>è¾¹ç¼˜å¸§ 1 (edge_0001)</h4>
                        <div class="frame">
                            <img src="data/edge_frames/edge_0001.png" alt="è¾¹ç¼˜å¸§1">
                            <div class="frame-label">å±…ä¸­åœ†å½¢ + åå­—çº¿</div>
                        </div>
                    </div>
                    <div class="frame-group">
                        <h4>è¾¹ç¼˜å¸§ 2 (edge_0002)</h4>
                        <div class="frame">
                            <img src="data/edge_frames/edge_0002.png" alt="è¾¹ç¼˜å¸§2">
                            <div class="frame-label">å³ç§»åœ†å½¢ + åå­—çº¿</div>
                        </div>
                    </div>
                </div>
                
                <h3>ç”Ÿæˆç»“æœå¯¹æ¯”</h3>
                <div class="two-col">
                    <div class="frame-group">
                        <h4>âœ¨ å¯ç”¨ TTLG</h4>
                        <div class="frame">
                            <img src="outputs/frame_0001.png" alt="TTLG å¸§1">
                            <div class="frame-label">Frame 1 - åœ†å½¢å±…ä¸­</div>
                        </div>
                        <div class="frame">
                            <img src="outputs/frame_0002.png" alt="TTLG å¸§2">
                            <div class="frame-label">Frame 2 - åœ†å½¢å³ç§»</div>
                        </div>
                    </div>
                    <div class="frame-group">
                        <h4>ğŸš« æ—  TTLG (Baseline)</h4>
                        <div class="frame">
                            <img src="outputs_no_ttlg/frame_0001.png" alt="æ— TTLG å¸§1">
                            <div class="frame-label">Frame 1 - åœ†å½¢å±…ä¸­</div>
                        </div>
                        <div class="frame">
                            <img src="outputs_no_ttlg/frame_0002.png" alt="æ— TTLG å¸§2">
                            <div class="frame-label">Frame 2 - åœ†å½¢å³ç§»</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- åˆ†æ -->
            <div class="section">
                <h2>ğŸ“Š ç»“æœåˆ†æ</h2>
                
                <div class="analysis-box">
                    <h4>âœ… TTLG æœ‰æ•ˆæ€§éªŒè¯</h4>
                    <ul class="observation-list">
                        <li><strong>è¾¹ç¼˜å¼•å¯¼ç”Ÿæ•ˆï¼š</strong>TTLG ç‰ˆæœ¬è¾¹ç¼˜æ›´æŸ”å’Œï¼Œæ—  TTLG ç‰ˆæœ¬æœ‰æ˜æ˜¾åå­—çº¿ä¼ªå½±</li>
                        <li><strong>ç»“æ„æ§åˆ¶å‡†ç¡®ï¼š</strong>åœ†å½¢æŒ‰è¾¹ç¼˜è¾“å…¥æ­£ç¡®ä»å±…ä¸­ç§»åŠ¨åˆ°å³ä¾§</li>
                        <li><strong>é£æ ¼è¿ç§»ï¼š</strong>ç”Ÿæˆç»“æœå‘ˆç°æŸ”å’Œé‡‘å±è´¨æ„Ÿï¼Œç¬¦åˆ"å°†å›¾2æŒ‰å›¾1å˜å½¢"çš„æç¤ºè¯</li>
                    </ul>
                </div>
                
                <div class="analysis-box" style="background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);">
                    <h4>âš ï¸ æ”¹è¿›ç©ºé—´</h4>
                    <ul class="observation-list">
                        <li class="warning"><strong>é£æ ¼æ¼‚ç§»ï¼š</strong>ç”Ÿæˆè‰²è°ƒï¼ˆç±³è‰²/ç°è‰²ï¼‰ä¸åˆå§‹åŒ–å¸§ï¼ˆé²œè‰³æ¸å˜ï¼‰å·®å¼‚è¾ƒå¤§</li>
                        <li class="warning"><strong>Gram å¼•å¯¼ä¸è¶³ï¼š</strong>å¯èƒ½éœ€è¦å¢åŠ  gram_scale æƒé‡æˆ–è°ƒæ•´ VGG å±‚é€‰æ‹©</li>
                        <li class="info"><strong>åˆ†è¾¨ç‡å˜åŒ–ï¼š</strong>VAE è‡ªåŠ¨å°† 512Ã—512 ä¸Šé‡‡æ ·è‡³ 1024Ã—1024</li>
                    </ul>
                </div>
                
                <h3>å¯¹æ¯”ç»†èŠ‚</h3>
                <table>
                    <tr>
                        <th>æŒ‡æ ‡</th>
                        <th>æœ‰ TTLG</th>
                        <th>æ—  TTLG</th>
                    </tr>
                    <tr>
                        <td>è¾¹ç¼˜ä¼ªå½±</td>
                        <td>âœ… è¾ƒå°‘ï¼Œè¾¹ç¼˜æŸ”å’Œ</td>
                        <td>âŒ æ˜æ˜¾åå­—çº¿</td>
                    </tr>
                    <tr>
                        <td>ç»“æ„ç²¾åº¦</td>
                        <td>âœ… åœ†å½¢ä½ç½®å‡†ç¡®</td>
                        <td>âœ… åœ†å½¢ä½ç½®å‡†ç¡®</td>
                    </tr>
                    <tr>
                        <td>é£æ ¼ä¸€è‡´æ€§</td>
                        <td>âš ï¸ ä¸­ç­‰</td>
                        <td>âš ï¸ ä¸­ç­‰</td>
                    </tr>
                    <tr>
                        <td>è§†è§‰è‡ªç„¶åº¦</td>
                        <td>âœ… æ›´è‡ªç„¶</td>
                        <td>âŒ è¾¹ç¼˜ç”Ÿç¡¬</td>
                    </tr>
                </table>
            </div>
            
            <!-- ä½¿ç”¨å‘½ä»¤ -->
            <div class="section">
                <h2>ğŸ’» å¤ç°å‘½ä»¤</h2>
                
                <h3>å¯ç”¨ TTLG ç”Ÿæˆ</h3>
                <div class="code-block">
python scripts/qwen_video_edit.py \
  --init_frame data/init.png \
  --edge_frames_dir data/edge_frames \
  --out_frames_dir outputs \
  --num_inference_steps 4 \
  --ttlg_edge_scale 1.0 \
  --ttlg_gram_scale 0.2 \
  --ttlg_lr 0.05 \
  --ttlg_last_steps 2 \
  --seed 42 \
  --dtype bf16
                </div>
                
                <h3>Baseline ç”Ÿæˆï¼ˆæ—  TTLGï¼‰</h3>
                <div class="code-block">
python scripts/qwen_video_edit.py \
  --init_frame data/init.png \
  --edge_frames_dir data/edge_frames \
  --out_frames_dir outputs_no_ttlg \
  --num_inference_steps 4 \
  --seed 42 \
  --dtype bf16
                </div>
            </div>
            
            <!-- ç»“è®º -->
            <div class="section">
                <h2>ğŸ“ ç»“è®º</h2>
                
                <div class="highlight">
                    <p><strong>TTLG æŠ€æœ¯æˆåŠŸåº”ç”¨äº Qwen-Image-Edit-2509 è§†é¢‘ç¼–è¾‘ä»»åŠ¡ã€‚</strong></p>
                    <p>å®éªŒè¯æ˜äº†ä»¥ä¸‹å…³é”®ç»“è®ºï¼š</p>
                    <ol style="margin-left: 20px; margin-top: 10px;">
                        <li>è¾¹ç¼˜å¼•å¯¼å¯æœ‰æ•ˆå‡å°‘ç”Ÿæˆå›¾åƒçš„ç¡¬è¾¹ä¼ªå½±</li>
                        <li>Qwen çš„æ‰“åŒ…æ½œå˜é‡æ ¼å¼éœ€è¦ç‰¹æ®Šå¤„ç†æ‰èƒ½è¿›è¡Œå¯å¾®åˆ†è§£ç </li>
                        <li>ä»… 4 æ­¥å»å™ªå³å¯è·å¾—å¯ç”¨çš„è§†é¢‘å¸§ï¼Œé€‚åˆå¿«é€ŸåŸå‹éªŒè¯</li>
                        <li>é£æ ¼å¼•å¯¼ï¼ˆGram Lossï¼‰éœ€è¦è¿›ä¸€æ­¥è°ƒå‚ä»¥æ”¹å–„é£æ ¼ä¸€è‡´æ€§</li>
                    </ol>
                </div>
                
                <h3>åç»­ä¼˜åŒ–æ–¹å‘</h3>
                <ul class="observation-list">
                    <li class="info">å¢åŠ æ¨ç†æ­¥æ•°è‡³ 20-50 æ­¥ä»¥è·å¾—æ›´é«˜è´¨é‡</li>
                    <li class="info">è°ƒæ•´ Gram Loss æƒé‡å’Œ VGG ç‰¹å¾å±‚é€‰æ‹©</li>
                    <li class="info">å¯ç”¨ Temporal Loss å¢å¼ºå¸§é—´æ—¶åºä¸€è‡´æ€§</li>
                    <li class="info">ä½¿ç”¨çœŸå®è§†é¢‘è¾¹ç¼˜åºåˆ—è¿›è¡Œæ›´å¤§è§„æ¨¡æµ‹è¯•</li>
                </ul>
            </div>
        </div>
        
        <div class="footer">
            <p>Qwen Video Edit TTLG Experiment Report | ç”Ÿæˆæ—¶é—´: 2026-02-06</p>
        </div>
    </div>
</body>
</html>
